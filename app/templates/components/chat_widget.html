<!-- AI Book Assistant Chat Widget -->
<div id="chat-widget" class="fixed bottom-4 right-4 z-50 hidden">
    <div class="bg-white rounded-lg shadow-2xl w-96 h-[500px] flex flex-col">
        <!-- Chat Header -->
        <div class="bg-blue-600 text-white p-4 rounded-t-lg flex justify-between items-center">
            <div class="flex items-center gap-2">
                <span class="text-2xl">ü§ñ</span>
                <div>
                    <h3 class="font-bold">AI Book Assistant</h3>
                    <span class="text-xs opacity-75">Powered by Ollama</span>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <span id="connection-status" class="connection-status">üî¥</span>
                <button id="clear-chat" class="hover:bg-blue-700 p-1 rounded" title="Clear chat">
                    üóëÔ∏è
                </button>
                <button onclick="document.getElementById('chat-widget').classList.add('hidden')" 
                        class="hover:bg-blue-700 p-1 rounded">
                    ‚úï
                </button>
            </div>
        </div>
        
        <!-- Chat Messages -->
        <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50">
            <!-- Welcome message -->
            <div class="message assistant">
                <div class="avatar">ü§ñ</div>
                <div class="message-content">
                    Hello! I'm your AI Book Assistant. How can I help you find your next great read?
                </div>
            </div>
        </div>
        
        <!-- Chat Input -->
        <div class="p-4 border-t bg-white rounded-b-lg">
            <div class="flex gap-2">
                <input 
                    type="text" 
                    id="chat-input" 
                    placeholder="Ask about books..."
                    class="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
                    autocomplete="off"
                >
                <button 
                    id="send-button"
                    class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"
                >
                    Send
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Chat Toggle Button -->
<button 
    id="chat-toggle"
    class="fixed bottom-4 right-4 z-40 bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition-all transform hover:scale-110"
    title="Open AI Assistant"
>
    <span class="text-2xl">üí¨</span>
</button>

<!-- Chat Styles -->
<style>
.message {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.message.user {
    flex-direction: row-reverse;
}

.message .avatar {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
}

.message-content {
    max-width: 80%;
    padding: 10px 14px;
    border-radius: 12px;
    background: white;
    box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.message.user .message-content {
    background: #3B82F6;
    color: white;
}

.message.thinking .message-content {
    background: #f3f4f6;
    color: #6b7280;
}

.thinking-dots::after {
    content: '...';
    animation: dots 1.4s steps(4, end) infinite;
}

@keyframes dots {
    0%, 20% { content: ''; }
    40% { content: '.'; }
    60% { content: '..'; }
    80%, 100% { content: '...'; }
}

.connection-status {
    font-size: 10px;
}

.connection-status.connected {
    color: #10b981;
}

.connection-status.error {
    color: #ef4444;
}

.mini-book-card {
    background: white;
    border: 1px solid #e5e7eb;
    padding: 12px;
    margin: 5px 0;
    border-radius: 8px;
    transition: all 0.2s;
}

.mini-book-card:hover {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transform: translateY(-1px);
}

.mini-book-card h4 {
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 4px;
}

.mini-book-card p {
    color: #6b7280;
    font-size: 14px;
}

.view-link {
    color: #3b82f6;
    font-size: 14px;
    text-decoration: none;
    margin-top: 8px;
    display: inline-block;
}

.view-link:hover {
    text-decoration: underline;
}

.book-results {
    margin: 10px 0;
}

.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 12px 20px;
    border-radius: 8px;
    color: white;
    font-weight: 500;
    animation: slideIn 0.3s ease-out;
    z-index: 1000;
}

@keyframes slideIn {
    from { transform: translateX(100%); }
    to { transform: translateX(0); }
}

.notification.success {
    background: #10b981;
}

.notification.error {
    background: #ef4444;
}
</style>
